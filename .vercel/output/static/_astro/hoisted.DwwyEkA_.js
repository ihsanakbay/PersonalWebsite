const m=document.getElementById("themeSwitch"),b=localStorage.getItem("theme"),k=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";b!==null?m.value=b:m.value=k;function C(i){const t=i==="system"?k:i;document.documentElement.classList.remove("light","dark"),document.documentElement.classList.add(t),localStorage.setItem("theme",i)}C(m.value);m.addEventListener("change",i=>{const t=i.target;C(t.value)});window.addEventListener("beforeprint",()=>{document.documentElement.classList.remove("dark")});window.addEventListener("afterprint",()=>{(m.value==="dark"||m.value==="system"&&k==="dark")&&document.documentElement.classList.add("dark")});function n(i,t){const e=document.createElement(i);return t&&typeof t=="string"&&t!==""&&(e.textContent=t),t&&typeof t=="object"&&Object.keys(t).forEach(s=>{e.setAttribute(s,t[s])}),e}function h(i,t,e){i.addEventListener(t,e)}function T(i){const t=i.match(/\w+$/)?.[0]??"";return t===""||t.length>1?"":t.toUpperCase()}const S=["Control","Shift","Alt","Meta"],x=["Control+T","Control+Shift+T","Control+W","Control+Shift+W","Control+N","Control+Shift+N","Control+Tab","Control+Shift+Tab","Meta+T","Meta+Shift+T","Meta+W","Meta+Shift+W","Meta+N","Meta+Shift+N","Meta+Tab","Meta+Shift+Tab"];function K(i){const t=i.match(/\w+/g)??[];if(t.length===0)return!1;const e=t.map(s=>s.toUpperCase()==="CTRL"?"Control":s.toUpperCase()==="CMD"?"Meta":s[0].toUpperCase()+s.slice(1).toLowerCase()).join("+");return!x.includes(e)&&e.split("+").slice(0,-1).every(s=>S.includes(s))}class M{instance;#a=null;#t=null;#e=[];currentIndex=0;#s="Escape";#o;#i="K";#n="Search command";#r="black";#d=new MutationObserver(this.#m.bind(this));constructor({closeKey:t,placeholder:e,activationLetter:s}={}){if(document.getElementById("hotkeypad")==null)throw new Error("HotKeyPad instance not found in the DOM");return this.instance=document.getElementById("hotkeypad"),this.#o=navigator.userAgent.includes("Macintosh")?"Cmd":"Ctrl",t&&t!==""&&(this.#s=t),e&&e!==""&&(this.#n=e),s&&s!==""&&(this.#i=s),this.#p(),this.#u(),this}#u(){h(document,"keydown",t=>{const e=`Key${this.#i.toUpperCase()}`;t.code===e&&(t.metaKey||t.ctrlKey)&&(t.preventDefault(),this.#k?this.close():this.open()),t.key.toLowerCase()===this.#s.toLowerCase()&&this.close()}),this.#d.observe(this.instance,{attributes:!0,attributeFilter:["class"],childList:!1,characterData:!1}),this.#g(),this.#C(),this.#w(),this.#L()}#p(){this.instance.hasAttribute("data-placeholder")&&this.instance.getAttribute("data-placeholder")!==""&&(this.#n=this.instance.getAttribute("data-placeholder")),this.instance.hasAttribute("data-activation-letter")&&this.instance.getAttribute("data-activation-letter")!==""&&(this.#i=this.instance.getAttribute("data-activation-letter").toUpperCase()),this.instance.hasAttribute("data-close-key")&&this.instance.getAttribute("data-close-key")!==""&&(this.#s=this.instance.getAttribute("data-close-key").toUpperCase())}#m(t){const{attributeName:e,target:s}=t[0];e==="class"&&(s.classList.contains("dark")?this.#r="white":this.#r="black",this.#h())}#y(){h(this.instance,"keydown",t=>{(t.metaKey||t.ctrlKey)&&this.#e.find(({hotkey:e,handler:s})=>{const a=`Key${T(e)}`;return t.code===a&&(t.preventDefault(),s!=null&&setTimeout(()=>s(),200),this.close()),!1})}),h(this.#t,"click",t=>{const e=t.target;e.tagName==="LI"&&this.#c(e),e.parentElement?.tagName==="LI"&&this.#c(e.parentElement)}),h(this.#t,"mouseover",t=>{const e=t.target;e.tagName==="LI"&&(this.#l.forEach(s=>s.removeAttribute("data-active")),e.setAttribute("data-active",""))}),h(this.#t,"keydown",t=>{const e=this.#l;this.currentIndex=Array.from(e).findIndex(o=>o.hasAttribute("data-active")),this.currentIndex=this.currentIndex===-1?0:this.currentIndex;let s=0;t.key==="Enter"&&(t.preventDefault(),this.#c(e[this.currentIndex]),e[this.currentIndex].removeAttribute("data-active"),this.currentIndex=0),t.key==="ArrowUp"&&(t.preventDefault(),s=this.currentIndex-1<0?e.length-1:this.currentIndex-1),t.key==="ArrowDown"&&(t.preventDefault(),s=this.currentIndex+1>e.length-1?0:this.currentIndex+1),t.key==="Tab"&&(t.preventDefault(),s=this.currentIndex+1>e.length-1?0:this.currentIndex+1),e[this.currentIndex].removeAttribute("data-active"),e[s].setAttribute("data-active","")}),h(this.#t,"input",t=>{const s=t.target.value.toLowerCase();this.#t.querySelectorAll("[data-section]").forEach(a=>{const r=a.querySelector("ul");r.querySelectorAll("li").forEach(l=>{l.querySelector("p").innerText.toLowerCase().includes(s)?l.style.display="flex":l.style.display="none"}),r.querySelectorAll("li[style='display: flex;']").length===0?a.style.display="none":a.style.display="block"})})}#c(t){this.#e.find(({hotkey:e,handler:s})=>(t.getAttribute("data-hotkey")===e&&(s!=null&&setTimeout(()=>s(),200),this.close()),!1))}#f(t){if(t.length===0)throw new Error("The commands array cannot be empty");return t.forEach(e=>{if(e.id===""||e.title===""||e.hotkey===""||e.handler==null)throw new Error("The command object is not valid. It should contain an id, title, hotkey and handler");if(!K(e.hotkey))throw new Error("The hotkey is not valid. It should only contain CTRL, CMD, ALT, SHIFT and a letter. Also it cannot contain browser or system reserved hotkeys such as CTRL+T, CTRL+N, CTRL+W, etc.");if(e.icon!=null&&typeof e.icon!="string")throw new Error("The icon should be a string");if((e.hotkey.match(/\w+/g)??[]).length>2)throw new Error("The hotkey only supports 2 keys maximum")}),t}open(){window.dispatchEvent(new CustomEvent("hotkeypad:open")),this.instance.style.opacity="1",this.instance.style.visibility="visible",this.instance.style.pointerEvents="auto",setTimeout(()=>this.#t.querySelector("input").focus(),200)}close(){window.dispatchEvent(new CustomEvent("hotkeypad:close")),this.instance.style.opacity="0",this.instance.style.visibility="hidden",this.instance.style.pointerEvents="none",this.#t.querySelector("input").value="",this.#t.removeEventListener("keydown",()=>{}),this.#t.removeEventListener("mouseover",()=>{}),this.#t.removeEventListener("input",()=>{})}setCommands(t){this.#e=this.#f(t),this.#h(),this.#y()}get#k(){return this.instance.style.visibility==="visible"}get activationKey(){return this.#o}get#v(){const t=new Map;return this.#e.forEach(e=>{const s=typeof e.section!="string"||e.section===""?"Unlisted":e.section,{section:o,...a}=e,r=t.get(s);r?r.push(a):t.set(s,[a])}),Array.from(t)}get#l(){return this.#t.querySelectorAll("li")}#E(t){return`https://cdn.simpleicons.org/${t}/${this.#r}`}#b(t){return/<svg/.test(t)||/<img/.test(t)||/<i/.test(t)||t===""}#g(){this.#a=n("div",{"data-backdrop":"","aria-hidden":"true"}),h(this.#a,"click",()=>this.close()),this.instance.appendChild(this.#a)}#C(){this.#t=n("div",{"data-container":""}),this.instance.appendChild(this.#t)}#w(){const t=n("header"),e=n("input",{type:"text",placeholder:this.#n,"aria-label":this.#n,autocomplete:"off",spellcheck:"false"});t.appendChild(e),this.#t.appendChild(t)}#L(){const t=n("footer"),e=n("kbd","↩"),s=n("kbd","↑"),o=n("kbd","↓"),a=n("kbd",this.#s),r=n("kbd",`${this.#o} + ${this.#i}`),c=n("p"," to select"),d=n("p"," to navigate"),l=n("p"," to close");c.prepend(e),d.prepend(s,o),l.prepend(r,a),t.append(c,d,l),this.#t.appendChild(t)}#I(){const t=n("div");t.setAttribute("data-sections",""),this.#v.forEach(([e,s])=>{const o=n("div");if(o.setAttribute("data-section",e.toLowerCase()),e!=="Unlisted"){const r=n("h4",e);o.appendChild(r)}const a=n("ul");s.forEach(({title:r,icon:c,hotkey:d})=>{const l=d.split("+").map(p=>p.trim());c==null&&(c="");const f=this.#b(c)?c:`<img src="${this.#E(c)}" alt="${r}" />`,u=n("li");if(u.setAttribute("data-hotkey",d),u.setAttribute("tabindex","0"),f!==""){const p=n("span");p.innerHTML=f,u.appendChild(p)}const v=n("p");v.append(r);const E=n("div");l.forEach(p=>{const A=n("span",p);E.appendChild(A)}),u.appendChild(v),u.appendChild(E),a.appendChild(u)}),o.appendChild(a),t.appendChild(o)}),this.#t.insertBefore(t,this.#t.lastChild)}#h(){const t=this.#t.querySelector("[data-sections]");t&&t.remove(),this.#I(),this.#l[0].setAttribute("data-active","")}}const w=new M,D=w.instance.getAttribute("data-info")??"[]",U=JSON.parse(D),$=U.map(({url:i,hotkey:t,icon:e,id:s,section:o,title:a})=>({id:s,title:a,icon:e,hotkey:t,section:o,handler:()=>{window.open(i,"_blank")}}));w.setCommands([...$]);const N=document.querySelectorAll(".footer-button");N.forEach(i=>{i.addEventListener("click",()=>{var t=new KeyboardEvent("keydown",{key:"K",code:"KeyK",keyCode:75,which:75,ctrlKey:!0,altKey:!1,shiftKey:!1,metaKey:!1});document.dispatchEvent(t)})});const y=document.getElementById("themeSwitch"),g=localStorage.getItem("theme"),L=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";g!==null?y.value=g:y.value=L;function I(i){const t=i==="system"?L:i;document.documentElement.classList.remove("light","dark"),document.documentElement.classList.add(t),localStorage.setItem("theme",i)}I(y.value);y.addEventListener("change",i=>{const t=i.target;I(t.value)});
